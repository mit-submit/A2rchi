<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="description" content="None" />
      <link rel="shortcut icon" href="img/favicon.ico" />
    <title>A2rchi Docs</title>
    <link rel="stylesheet" href="css/theme.css" />
    <link rel="stylesheet" href="css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Getting Started";
        var mkdocs_page_input_path = "index.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="." class="icon icon-home"> A2rchi Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Getting Started</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#system-requirements">System Requirements</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#install">Install</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#secrets">Secrets</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#basic-cli-overview">Basic CLI Overview</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#required-configuration-fields">Required configuration fields</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#create-new-instance">Create new instance</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#removing-deployment">Removing deployment</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#helpful-notes-for-production-deployments">Helpful Notes for Production Deployments</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#running-multiple-deployments-on-the-same-machine">Running multiple deployments on the same machine</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#persisting-data-between-deployments">Persisting data between deployments</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="users_guide/">User's Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="developers/">Developer's Guide</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="about/">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href=".">A2rchi Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="getting-started">Getting Started</h1>
<p>A2rchi is an AI Augmented Research Chat Intelligence, originally built for the subMIT project at the MIT physics department. </p>
<p>At it's core, A2rchi is a RAG chat model which takes in a corpus of data and returns natural language output. However, there are a couple of things that make the A2rchi project unique and specialized toward research and education:</p>
<ul>
<li>
<p>Along with a native chat interface, A2rchi comes shipped with various other interfaces that enable it to do things such as: give suggestions for answers on a student help forum and help tech support teams answers emails and create tickets.</p>
</li>
<li>
<p>A2rchi's fully customizable configuration allows users to tweak and adjust everything from prompts, to context lengths, to documents uploaded, etc. and is easy to deploy and modify.</p>
</li>
</ul>
<h2 id="system-requirements">System Requirements</h2>
<p>A2rchi is containized and is deployed with a python-based CLI. Therefore, it requires:</p>
<ul>
<li>
<p><code>docker</code> version 24+ (for containers)</p>
</li>
<li>
<p><code>python 3.10.0+</code> (for CLI)</p>
</li>
</ul>
<h2 id="install">Install</h2>
<p>A2rchi's CLI can be used to <code>create</code> and <code>delete</code> instances of an a2rchi deployment and provides the installation needed for A2rchi. </p>
<p>To install the CLI, first clone the a2rchi repo:</p>
<pre><code>$ git clone https://github.com/mit-submit/A2rchi.git
</code></pre>
<p>Then, activate a virtual/conda environment and from the root of the repository (i.e. where the <code>pyproject.toml</code> file is) by running:</p>
<pre><code>$ pip install .
</code></pre>
<p>This will install A2rchi's dependencies as well as a local CLI tool. You should be able to see that it is installed using the <code>which</code> command (your output will be slightly different):</p>
<pre><code>$ which a2rchi
/Users/default_user/A2rchi/venv/bin/a2rchi
</code></pre>
<h2 id="secrets">Secrets</h2>
<p>Secrets are values which are sensitive and therefore should not be directly included in code or configuration files. They typically include passwords, API keys, etc. </p>
<p>To manage these secrets, we ask that you write them to a location on your file system in <code>.txt</code> files titled the name of the secrets. You will then give the location of the folder to the configuration file (see next section). You may also use multiple different folders/locations and supply them all to the configuration.</p>
<p>The secrets you are required to have to start a2rchi are:
- <code>openai_api_key</code>: the API key given by openAI
- <code>anthropic_api_key</code>: the API key given by anthropic
- <code>hf_token</code>: the API key to your huggingface account.
- <code>pg_password</code>: some password you pick which encrypts the database.</p>
<p>Note that you technically only need the API key for the models that you are using (by default openAI), so for the other ones you can just put in dummy variables. (Yes, we know it's not the cleanest way to do it...)</p>
<h2 id="basic-cli-overview">Basic CLI Overview</h2>
<p>A2rchi's CORE launches its chat interface and data management interface. The CORE CLI has the following commands:</p>
<pre><code>a2rchi create --name &lt;name&gt; --a2rchi-config &lt;path-to-config&gt;
a2rchi delete --name &lt;name&gt;
</code></pre>
<p>The <code>--name</code> represents the name of your a2rchi deployment and by default the files for your deployment will be stored under <code>~/.a2rchi/a2rchi-{name}</code> on your local machine (you don't need to do anything with them, this is just an FYI).</p>
<p>The <code>--a2rchi-config</code> is a configuration file provided by the user which can override any of the templatable fields in <code>a2rchi/templates/base-config.yaml</code>. </p>
<h3 id="required-configuration-fields">Required configuration fields</h3>
<p>There are a few required fields that must be included in every configuration. They are:</p>
<ol>
<li>
<p><strong><code>name</code></strong>: The name of the configuration (NOTE: this is not neccessarily the name of the a2rchi deployment described above)</p>
</li>
<li>
<p><strong><code>global:TRAINED_ON</code></strong>: A quick couple words describing the data that you want A2rchi to specialize in. For example, "introductory classical mechanics" or "the subMIT cluster at MIT."</p>
</li>
<li>
<p><strong><code>chains:input_lists</code></strong>: A list of file(s), each containing a list of websites seperated by new lines, used for A2rchi's starting context (more can be uploaded later). For example, <code>configs/miscellanea.list</code> contains information of the MIT proffessors who started the A2rchi project:</p>
</li>
</ol>
<pre><code># web pages of various people
https://people.csail.mit.edu/kraska
https://physics.mit.edu/faculty/christoph-paus
</code></pre>
<ol>
<li>
<p><strong><code>chains:prompts:CONDENSING_PROMPT</code></strong>: A condensing prompt is a prompt used to condense a chat history and a follow up question into a stand alone question. This configuration line gives the path, relative to the root of the repo, of a file containing a condensing prompt. All condensing prompts must have the following tags in them, which will be filled with the appropriate information: <code>{chat_history}</code> and <code>{question}</code>. A very general prompt for condensing histories can be found at <code>configs/prompts/condense.prompt</code>, so for base installs it will not need to be modified. </p>
</li>
<li>
<p><strong><code>chains:prompts:SUMMARY_PROMPT</code></strong>: #TODO: I don't actually know what this does... For now just link it a blank file....</p>
</li>
<li>
<p><strong><code>chains:prompts:MAIN_PROMPT:</code></strong>: A main prompt is a prompt used to qurery LLM with appropriate context and question. This configuration line gives the path, relative to the root of the repo, of a file containing a main prompt. All main prompts must have the following tags in them, which will be filled with the appropriate information: <code>{question}</code> and <code>{context}</code>. An example prompt specific to subMIT can be found here: <code>configs/prompts/submit.prompt</code> (it will not perform well for other applications where it is recommeneded to write your own prompt and change it in the config)</p>
</li>
<li>
<p><strong><code>location_of_secrets</code></strong>: A list of the absolute paths of folders containing secrets (passwords, API keys, etc.), discussed explicitly in the previous section. </p>
</li>
</ol>
<p>Below is an example of a bare minimum condifiguration file:</p>
<pre><code># stored in file example_conf.yaml
name: bare_minimum_configuration #REQUIRED

global:
  TRAINED_ON: &quot;subMIT and the people who started A2rchi&quot; #REQUIRED

chains:
  input_lists: #REQUIRED
    - config_old/submit.list
    - config_old/miscellanea.list
  prompts:
    CONDENSING_PROMPT: config_old/prompts/condense.prompt #REQUIRED
    MAIN_PROMPT: config_old/prompts/submit.prompt #REQUIRED
    SUMMARY_PROMPT: config_old/prompts/summary.prompt #REQUIRED

location_of_secrets: #REQUIRED
  - ~/.secrets/a2rchi_base_secrets
</code></pre>
<p>To view the full list of configuration variables, please refer to the users guide. </p>
<h3 id="create-new-instance">Create new instance</h3>
<p>Now, to create an instance of an A2rchi deployment called <code>my-a2rchi</code>, simply create a file called <code>example_conf.yaml</code> with the contents like the ones above and run:</p>
<pre><code>$ a2rchi create --name my-a2rchi --a2rchi-config example_conf.yaml
</code></pre>
<p>It will take up to (a few) seconds(s) for the command to finish (and possibly longer (minutes or dozens of minutes) the first time you run it b/c <code>docker</code> will have to build the container images from scratch), but you should ultimately see output similar to:</p>
<pre><code>[a2rchi]&gt;&gt; Creating docker volumes
[a2rchi]&gt;&gt; Creating docker volume: a2rchi-my-a2rchi
[a2rchi]&gt;&gt; Creating docker volume: a2rchi-pg-my-a2rchi
[a2rchi]&gt;&gt; Creating docker volume: a2rchi-grafana-my-a2rchi
[a2rchi]&gt;&gt; Preparing Grafana
[a2rchi]&gt;&gt; Preparing Postgres
[a2rchi]&gt;&gt; Preparing Compose
[a2rchi]&gt;&gt; Starting docker compose
...
... A lot of logs from pulling and extracting images ...
...
Network a2rchi-my-a2rchi_default  Creating
Network a2rchi-my-a2rchi_default  Created
Container postgres-my-a2rchi  Creating
Container chromadb-my-a2rchi  Creating
Container postgres-my-a2rchi  Created
Container chromadb-my-a2rchi  Created
Container grafana-my-a2rchi  Creating
Container chat-my-a2rchi  Creating
Container grafana-my-a2rchi  Created
Container chat-my-a2rchi  Created
Container postgres-my-a2rchi  Starting
Container chromadb-my-a2rchi  Starting
Container chromadb-my-a2rchi  Started
Container postgres-my-a2rchi  Started
Container chromadb-my-a2rchi  Waiting
Container postgres-my-a2rchi  Waiting
Container postgres-my-a2rchi  Waiting
Container postgres-my-a2rchi  Healthy
Container grafana-my-a2rchi  Starting
Container postgres-my-a2rchi  Healthy
Container grafana-my-a2rchi  Started
Container chromadb-my-a2rchi  Healthy
Container chat-my-a2rchi  Starting
Container chat-my-a2rchi  Started
</code></pre>
<p>You can verify that all your images are up and running properly by executing the following:</p>
<pre><code>$ docker ps -a
CONTAINER ID   IMAGE                          COMMAND                  CREATED         STATUS                   PORTS                    NAMES
7fd9015bf5df   mdr223/a2rchi:chat-0.0.1       &quot;python -u a2rchi/bi…&quot;   3 minutes ago   Up 2 minutes             0.0.0.0:7861-&gt;7861/tcp   chat-my-a2rchi
d1f749f12416   mdr223/a2rchi:grafana-0.0.1    &quot;/run.sh&quot;                3 minutes ago   Up 2 minutes             0.0.0.0:3000-&gt;3000/tcp   grafana-my-a2rchi
f1298d6efefc   postgres:16                    &quot;docker-entrypoint.s…&quot;   3 minutes ago   Up 2 minutes (healthy)   5432/tcp                 postgres-my-a2rchi
efcb7be30a6e   mdr223/a2rchi:chromadb-0.0.1   &quot;uvicorn chromadb.ap…&quot;   3 minutes ago   Up 2 minutes (healthy)   0.0.0.0:8000-&gt;8000/tcp   chromadb-my-a2rchi
</code></pre>
<p>To access the chat interface, visit its corresponding port (<code>0.0.0.0:7861</code> in the above example )</p>
<h3 id="removing-deployment">Removing deployment</h3>
<p>Lastly, to tear down the deployment, simply run:</p>
<pre><code>$ a2rchi delete --name my-a2rchi
</code></pre>
<h2 id="helpful-notes-for-production-deployments">Helpful Notes for Production Deployments</h2>
<p>You may wish to use the CLI in order to stage production deployments. This section covers some useful notes to keep in mind.</p>
<h3 id="running-multiple-deployments-on-the-same-machine">Running multiple deployments on the same machine</h3>
<p>The CLI is built to allow multiple deployments to run on the same daemon. The docker networks between all the deployments are seperate, so there is very little risk of them accidentally communicating with one another.</p>
<p>However, one thing to be careful of is the external ports. Suppose you're running two deployments and both of them are running the chat on port 8000. There is no way to view both deployments at the same time from the same port, so instead you should split to forwarding the deployments to other external ports. Generally, this can be done in the configuration:</p>
<pre><code>interfaces:
  chat_app:
    EXTERNAL_PORT: 1000
  uploader_app:
    EXTERNAL_PORT: 1001
  grafana:
    EXTERNAL_PORT: 1002

utils:
  data_manager:
    chromadb_external_port: 1050
</code></pre>
<h3 id="persisting-data-between-deployments">Persisting data between deployments</h3>
<p>Docker volumes persist between deployments, so if you deploy an instance, and upload some further documents, you will not need to redo so every time you deploy. Of course, if you are editing any data, you should explicitly remove this infromation from the volume, or simply remove the volume itself with
```
docker volume rm <volume name></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="users_guide/" class="btn btn-neutral float-right" title="User's Guide">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
      <span><a href="users_guide/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="js/jquery-3.6.0.min.js"></script>
    <script>var base_url = ".";</script>
    <script src="js/theme_extra.js"></script>
    <script src="js/theme.js"></script>
      <script src="search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!--
MkDocs version : 1.6.1
Build Date UTC : 2025-03-04 18:41:09.051368+00:00
-->
